<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Rundis</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">
    <meta name="generator" content="JBake">

    <link href="/blog/css/bootstrap.min.css" rel="stylesheet">
    <link href="/blog/css/asciidoctor.css" rel="stylesheet">
    <link href="/blog/css/base.css" rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link href="/blog/css/prettify.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/blog/assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/blog/assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/blog/assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="/blog/assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="favicon.ico">
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-58695124-1', 'auto');
      ga('send', 'pageview');

    </script>
  </head>
  <body onload="prettyPrint()">
    <div id="wrap">

	<!-- Fixed navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/blog/index.html">Rundis</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/blog/about.html">About</a></li>
            <li><a href="feed.xml">Subscribe</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
    <div class="container">

	<div class="page-header">
		<h1>Blog</h1>
	</div>
  			<a href="/blog/2015/bootify-ring.html"><h1>Bootifying my ring app</h1></a>
  			<p>19 January 2015</p>
        <p><em>Tags: </em>
		      <a href="/blog/tags/clojure.html">clojure</a>
	      
		      <a href="/blog/tags/boot.clj.html"> boot.clj</a>
	      </p>
  			<p><div class="sect1">
<h2 id="_a_little_background">A little background</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A few weeks back I noticed a tweet about <a href="https://github.com/boot-clj/boot">boot-clj</a>. This weekend I finally had some time to look into whether it could
be a viable alternative to <a href="https://github.com/technomancy/leiningen">Leiningen</a> for our apps or not.
We have a couple of ring based apps running as uberjars, so I decided to try to make a boot build for one of the projects. For the purpose of this blogpost however
I&#8217;ve created a sample app. Source available on <a href="https://github.com/rundis/boot-sample">github</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_bother_with_an_alternative_when_there_is_leiningen">Why bother with an alternative when there is Leiningen ?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I haven&#8217;t been in the clojuresphere all that long.
I do have a history as java and groovy developer and have been through a history of using <a href="http://ant.apache.org/">ant</a>,
<a href="http://maven.apache.org/">maven</a> and lately <a href="https://www.gradle.org/">gradle</a> for my builds.
In terms of development experience Leiningen is definately a step up from all of them. However I feel Leiningen has left me longing
as soon as my builds have become a bit more elaborate (testing javascript, transpiling, create artifacts, upload to repo, run migrations
deploy to different environments etc). I&#8217;m sure all of this is achievable with Lein, but is it really architected to excel for that purpose ?
TBH I&#8217;d love to see gradle get some serious clojure love, but it doesn&#8217;t seem to be coming anytime soon. Maybe boot will be my next build tooling love :)</p>
</div>
<div class="ulist">
<div class="title">Reading up a bit on boot checked a few boxes for some of my longings though:</div>
<ul>
<li>
<p>Your build doesn&#8217;t have to be all declarative</p>
</li>
<li>
<p>Sensible abstractions and libraries to allow you to compose and extend your build using the full power of clojure</p>
</li>
<li>
<p>Compose build pipelines somewhat similar to how you would compose middlewares in ring</p>
</li>
<li>
<p>Task is the fundamental building block</p>
</li>
<li>
<p>Tasks typically works on immutable filesets (files treated as values, you never touch the filesystem directly yourself !)</p>
</li>
<li>
<p>Possibility of complete classpath isolation at task level</p>
</li>
<li>
<p>Great repl and commandline support.</p>
</li>
<li>
<p>&#8230; and surely a lots more</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lein_boot">Lein &#8594; Boot</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_leningen_project">Leningen project</h3>
<div class="paragraph">
<p>project.clj</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint clojure language-clojure"><code>(defproject boot-sample "0.1.0"
  :description "Boot sample application"
  :url "https://github.com/rundis/boot-sample"
  :min-lein-version "2.0.0"
  :dependencies [[org.clojure/clojure "1.6.0"]
                 [compojure "1.2.1"]
                 [liberator "0.12.2"]
                 [ring/ring-jetty-adapter "1.3.1"]
                 [ring/ring-json "0.3.1"]
                 [bouncer "0.3.1"]
                 [io.aviso/pretty "0.1.14"]]
  :ring {:handler boot-sample.core/app                       <b>(1)</b>
         :port 3360}
  :profiles {:dev {:plugins [[lein-ring "0.8.13"]]
                   :test-paths ^:replace []}
             :test {:dependencies [[midje "1.6.3"]]
                    :plugins [[lein-midje "3.1.3"]]
                    :test-paths ["test"]
                    :resource-paths ["test/resources"]}})

</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The entry point for my ring app</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The above project is a really simple project definition. To run my app I just have to execute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint bash language-bash"><code>lein ring uberjar
java -jar target/boot-sample-0.1.0-standalone.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>core.clj</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint clojure language-clojure"><code>(ns boot-sample.core
  (:require [ring.middleware.params :refer [wrap-params]]
            [ring.middleware.keyword-params :refer [wrap-keyword-params]]
            [ring.middleware.json :refer [wrap-json-params]]
            [compojure.core :refer [defroutes ANY GET]]
            [liberator.core :refer [defresource resource]]))

(defn index-handler [req]
  "Hello Boot sample (or maybe Lein still)")

(defresource booters
  :available-media-types       ["application/json"]
  :allowed-methods             [:get]
  :handle-ok                   (fn [ctx] [{:id "Pod1"} {:id "Pod 2"}]))

(defroutes app-routes
  (ANY "/" [] index-handler)
  (ANY "/booters" [] booters))


(def app (-&gt; app-routes
             wrap-keyword-params
             wrap-json-params
             wrap-params))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Hey. Hang on. There is no main method here, how can the java -jar command work without one ?
Well, because the ring plugin creates one for us.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint bash language-bash"><code>cat target classes/boot_sample/core/main.clj</code></pre>
</div>
</div>
<div class="paragraph">
<p>gives us</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint clojure language-clojure"><code>(do
  (clojure.core/ns boot-sample.core.main
   (:require ring.server.leiningen)
                   (:gen-class))
  (clojure.core/defn -main []
    (ring.server.leiningen/serve
     (quote {:ring {:auto-reload? false,
                    :stacktraces? false,
                    :open-browser? false,
                    :port 3360,
                    :handler boot-sample.core/app}}))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s useful to know in case boot-clj doesn&#8217;t happen to have a ring task that does something similar.</p>
</div>
</div>
<div class="sect2">
<h3 id="_boot_me_up">Boot me up</h3>
<div class="paragraph">
<p>Boot comes with a range of predefined tasks that I can compose to get quite close to the Leiningen build above.
I&#8217;ll focus on getting that uberjar up and running.</p>
</div>
<div class="paragraph">
<p>I could have done it all on the command line or in the boot repl, but lets just be a little declarative (still functions don&#8217;t worry!).</p>
</div>
<div class="paragraph">
<p>build.boot</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint clojure language-clojure"><code>(set-env!
 :resource-paths #{"src"}                                <b>(1)</b>
 :dependencies '[[org.clojure/clojure "1.6.0"]
                 [compojure "1.2.1"]
                 [liberator "0.12.2"]
                 [ring/ring-jetty-adapter "1.3.1"]
                 [ring/ring-json "0.3.1"]
                 [bouncer "0.3.1"]
                 [io.aviso/pretty "0.1.14"]])

(task-options!
 pom {:project 'boot-Sample
      :version "0.1.0"}
 aot {:namespace '#{boot-sample.core}}                  <b>(2)</b>
 jar {:main 'boot_sample.core                           <b>(3)</b>
      :manifest {"Description" "Sample boot app"
                 "Url" "https://github.com/rundis/boot-sample"}})


(deftask build
  "Build uberjar"
  []
  (comp (aot) (pom) (uber) (jar)))</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>To bundle your sources in the output jar, you have to specify src as a resource-path. A small gotcha there.</p>
</li>
<li>
<p>We need to aot our core.clj namespace so that java -jar can invoke it&#8217;s main method</p>
</li>
<li>
<p>We need to help java -jar with the location of our main class in the jar</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>However you might remember from above that there is no main method in core.clj.
So the last piece of the puzzle is to add one. It&#8217;t not that hard.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint clojure language-clojure"><code>(ns boot-sample.core
  (:require [ring.middleware.params :refer [wrap-params]]
            [ring.middleware.keyword-params :refer [wrap-keyword-params]]
            [ring.middleware.json :refer [wrap-json-params]]
            [compojure.core :refer [defroutes ANY GET]]
            [liberator.core :refer [defresource resource]]
            [ring.adapter.jetty :as jetty])                                <b>(1)</b>
  (:gen-class))                                                            <b>(2)</b>


;; ... the other stuff

(defn -main []
  (jetty/run-jetty app {:port 3360}))                                     <b>(3)</b>
</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Using the jetty ring adapter</p>
</li>
<li>
<p>The :gen-class directive generates the necessary stuff for our main method to be invokable from java
during aot compilation</p>
</li>
<li>
<p>Fire away</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>At the time of writing there was a regression in boot that caused aot to fail.
I needed to build boot from source, should be fixed in the next release though.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint bash language-bash"><code>git clone git@github.com:boot-clj/boot.git
cd boot/boot/core
lein install</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now all is set to try it out:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint bash language-bash"><code>boot build
java -jar target/boot-sample-0.1.0.jar</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_all_is_well_then">All is well then ?</h3>
<div class="paragraph">
<p>Unfortunately not quite. For uberjar projects it seems boot-clj at the time of writing has some serious
performance challenges.</p>
</div>
<div class="ulist">
<div class="title">On my machine generating the uberjar takes:</div>
<ul>
<li>
<p>Leiningen : 12 seconds</p>
</li>
<li>
<p>boot-clj  : 46 seconds !</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It&#8217;s not like Leiningen is lightning fast in the first place. But for this scenario boot just doesn&#8217;t cut it.
I reported an <a href="https://github.com/boot-clj/boot/issues/94">issue</a> and got prompt responses from the developers
which can only be a good sign.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_concluding_remarks">Concluding remarks</h2>
<div class="sectionbody">
<div class="paragraph">
<p>My initial question of whether or not I feel we could use boot for our current projects gets a thumbs down for now.</p>
</div>
<div class="paragraph">
<p>I think boot-clj carries a lot of promise and have some really great ideas. It&#8217;s going to be interesting to
see if boot-clj becomes a viable alternative to leiningen. I suppose a porting and/or interop story with lein
and lein plugins might be needed in addition to maturing both the model and obviously its performance characteristics.</p>
</div>
<div class="paragraph">
<p>I&#8217;m certainly keen on trying it out more. I might try out the clojurescript support next and maybe churn out some custom tasks
just for fun.</p>
</div>
</div>
</div></p>
  			<a href="/blog/2014/groovy_repl.html"><h1>Groovy Light Table Plugin</h1></a>
  			<p>19 May 2014</p>
        <p><em>Tags: </em>
		      <a href="/blog/tags/lighttable.html">lighttable</a>
	      
		      <a href="/blog/tags/clojurescript.html"> clojurescript</a>
	      
		      <a href="/blog/tags/groovy.html"> groovy</a>
	      
		      <a href="/blog/tags/screencast.html"> screencast</a>
	      </p>
  			<p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>A short demonstration of the repl like capabilities of my Light Table Groovy plugin (<a href="https://github.com/rundis/LightTable-Groovy">https://github.com/rundis/LightTable-Groovy</a>)</p>
</div>
<iframe width="560" height="315" src="http://www.youtube.com/embed/5ji8RR2A4gQ" frameborder="0" allowfullscreen></iframe>
</div>
</div></p>
  			<a href="/blog/2014/lt-snippets.html"><h1>Creating and using snippets in Light Table</h1></a>
  			<p>06 May 2014</p>
        <p><em>Tags: </em>
		      <a href="/blog/tags/lighttable.html">lighttable</a>
	      
		      <a href="/blog/tags/plugin.html"> plugin</a>
	      
		      <a href="/blog/tags/clojure.html"> clojure</a>
	      
		      <a href="/blog/tags/clojurescript.html"> clojurescript</a>
	      
		      <a href="/blog/tags/screencast.html"> screencast</a>
	      </p>
  			<p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>A short introduction to my Light Table Snippets plugin (<a href="https://github.com/rundis/lt-snippets">https://github.com/rundis/lt-snippets</a>).</p>
</div>
<iframe width="560" height="315" src="http://www.youtube.com/embed/I6iuXOw3HDQ" frameborder="0" allowfullscreen></iframe>
</div>
</div></p>
  			<a href="/blog/2014/instabuster_part2.html"><h1>JavaScript testing with Light Table and Buster.JS</h1></a>
  			<p>21 April 2014</p>
        <p><em>Tags: </em>
		      <a href="/blog/tags/lighttable.html">lighttable</a>
	      
		      <a href="/blog/tags/clojurescript.html"> clojurescript</a>
	      
		      <a href="/blog/tags/javascript.html"> javascript</a>
	      
		      <a href="/blog/tags/screencast.html"> screencast</a>
	      </p>
  			<p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Second part of the intro to the Light Table Buster plugin (<a href="https://github.com/busterjs/lt-instabuster">https://github.com/busterjs/lt-instabuster</a>)
This time demonstrating some of the more advanced features.</p>
</div>
<iframe width="560" height="315" src="http://www.youtube.com/embed/jYDiAVbPL8I" frameborder="0" allowfullscreen></iframe>
</div>
</div></p>
  			<a href="/blog/2014/instabuster_part1.html"><h1>JavaScript testing with Light Table and Buster.JS</h1></a>
  			<p>17 March 2014</p>
        <p><em>Tags: </em>
		      <a href="/blog/tags/lighttable.html">lighttable</a>
	      
		      <a href="/blog/tags/clojurescript.html"> clojurescript</a>
	      
		      <a href="/blog/tags/javascript.html"> javascript</a>
	      
		      <a href="/blog/tags/screencast.html"> screencast</a>
	      </p>
  			<p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Intro to the Light Table Buster plugin (<a href="https://github.com/busterjs/lt-instabuster">https://github.com/busterjs/lt-instabuster</a>)</p>
</div>
<iframe width="560" height="315" src="http://www.youtube.com/embed/WKHWazblpbc" frameborder="0" allowfullscreen></iframe>
</div>
</div></p>
  			<a href="/blog/2013/buster-plugin.html"><h1>Javascript testing in your JVM projects using Gradle and BusterJS</h1></a>
  			<p>19 August 2013</p>
        <p><em>Tags: </em>
		      <a href="/blog/tags/gradle.html">gradle</a>
	      
		      <a href="/blog/tags/groovy.html"> groovy</a>
	      
		      <a href="/blog/tags/javascript.html"> javascript</a>
	      
		      <a href="/blog/tags/buster.html"> buster</a>
	      
		      <a href="/blog/tags/screencast.html"> screencast</a>
	      </p>
  			<p><div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When I first started looking at testing in javascript land a while back I quickly felt lost in space.</p>
</div>
<div class="ulist">
<div class="title">Filled with questions like;</div>
<ul>
<li>
<p>which framework(s) to choose ?</p>
</li>
<li>
<p>how do I get framework x to work from my IDE ?</p>
</li>
<li>
<p>more importantly how to I manage to include the javascript tests in my CI builds ?</p>
</li>
<li>
<p>how can I avoid repetitive setup pain across projects ?</p>
</li>
<li>
<p>why is it such a hassle getting started ?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>I can&#8217;t say I have answered any of the questions above fully, but I have taken some strides in the right direction.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_buster_js">Buster.JS</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="http://docs.busterjs.org/en/latest/">Buster</a> is a flexible and modularized framework for writing and running your JavaScript tests.
There are others out there, but from what I could gather and based on advice from my frontend wizard colleagues I decided to give it a good go. It&#8217;s still in beta, but from my experiences so far its more than mature enough for proper use in projects.</p>
</div>
<div class="sect2">
<h3 id="_a_few_important_aspects_about_buster_js">A few important aspects about Buster.JS:</h3>
<div class="paragraph">
<p>Tests are run in real browsers (phantomjs for headless). No emulation bull
You can run tests in multiple browsers in parallell
Its really really fast
Write tests in the fashion that suits you (xUnit or spec)
Nice assertion library and integrated with Sinon.JS (powerful stubbing and spying)
&#8230; and lots more</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_gradle_buster_plugin">Gradle buster plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For my jvm project builds I use Gradle. Maven and Ant projects that spend time with me a few weeks tend to find themselves converted. So I set out to create a buster plugin for gradle, aptly named gradle-buster-plugin. Still early days, but already it has started to prove quite valuable.</p>
</div>
<div class="ulist">
<div class="title">The plugin has two high-level goals;</div>
<ul>
<li>
<p>Allow you to easily run javascripts as part of your CI builds</p>
</li>
<li>
<p>Provide you with a smooth development experience by adding value on top of whats already present in Buster.JS.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The homepage for the pluging is here: <a href="https://github.com/rundis/gradle-buster-plugin">https://github.com/rundis/gradle-buster-plugin</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_do_i_have_to_do_aka_getting_started">What do I have to do ? (aka getting started)</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_installing_preconditions">Installing preconditions</h3>
<div class="ulist">
<ul>
<li>
<p>Install node.js/npm - Mac: $ brew install node</p>
</li>
<li>
<p>Install Buster.JS  - $ npm install buster -g</p>
</li>
<li>
<p>Install Phantom.JS  - Mac: $ brew install phantomjs</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_set_up_the_buster_plugin_in_your_gradle_config">Set up the buster plugin in your gradle config</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint groovy language-groovy"><code>buildscript {
    repositories { jcenter() }
    dependencies {
        classpath  'org.gradle.buster:gradle-buster-plugin:0.2.4.1'
    }
}

apply plugin: 'war' // just assuming you have a war project
apply plugin: 'buster'

build.dependsOn busterTest // hook up javascript task in the build</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_set_up_a_buster_js_configuration_file">Set up a buster.js configuration file</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint javascript language-javascript"><code>var config = module.exports;

config["Sample JSTests"] = {
    environment: "browser",

    libs: ["src/main/webaapp/js/libs/jquery-1.10.2.js"],
    sources: ["src/main/web-app/js/app/**/*.js"],
    tests: ["src/test/js/**/*-test.js"]
};</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sample_unit">Sample unit</h3>
<div class="paragraph">
<p>So you could create a file like src/main/webapp/js/app/dummy-service.js</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint javascript language-javascript"><code>var myapp = this.myapp || {};
myapp.services = app.services || {};
(function () {
    myapp.services.DummyService = function (my) {
        my.listTodos = function(success, error) {
            $.get('/todos/list')
               .done(function(data) {
                  success(data);
               })
               .fail(function(jqXHR, textStatus, errorThrown) {
                  error("Error getting todos")
               });
        };
        return my;
    }(myapp.services.DummyService || {});
}());</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sample_unit_test">Sample unit test</h3>
<div class="paragraph">
<p>Create a corresponding unit test in src/test/js/app/dummy-service-test.js</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint javascript language-javascript"><code>(function () {
    buster.testCase("DummyService", {
        setUp: function() {
            this.service = myapp.services.DummyService;
            this.server = sinon.fakeServer.create();
            this.success = this.spy();
            this.error = this.spy();
        },
        tearDown: function () {
            this.server.restore();
        },
        "should successfully list todos": function () {
            this.service.listTodos(this.success, this.error);
            this.server.requests[0].respond(
                200,
                { "Content-Type": "application/json" },
                JSON.stringify([{ id: 1, text: "Provide examples", done: true }])
            );

            assert.calledOnce(this.success);
        },
        "should invoke error callback on errors": function () {
            this.service.listTodos(this.success, this.error);
            this.server.requests[0].respond(
                500,
                { "Content-Type": "application/json" },
                JSON.stringify([{ id: 1, text: "dummy", done: true }])
            );

            assert.calledOnce(this.error);
        }
    });
}());</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_running_the_tests_locally">Running the tests locally</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint bash language-bash"><code>$ gradle busterTest</code></pre>
</div>
</div>
<div class="paragraph">
<p>Test results are found in : build/busterTest-results/bustertests.xml</p>
</div>
<div class="paragraph">
<p>Autotesting
When doing your tdd cycles its quite useful to use the autotest feature (kinda like infinitest).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint bash language-bash"><code>$ gradle busterAutoTest</code></pre>
</div>
</div>
<div class="paragraph">
<p>Will leave the server running and listen for file changes in the patterns specified by the buster.js file above. So if I change the test or unit above a test run will automatically be fired off and results reported to the console. Its pretty fast so you should be able to keep a good flow going !
Just do Ctrl + C to kill the autotesting.</p>
</div>
<div class="paragraph">
<p>Multiple browsers
Its quite easy to set up just see the readme for the plugin</p>
</div>
<div class="paragraph">
<p>CI Server
Obviously you will need to set up the preconditions. If you&#8217;re server isn&#8217;t headless you have the option of testing with a few proper browsers(firefox and chrome on linux, safari if your server is mac&#8230; which I doubt).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Its certainly not perfect, but with the above you have a pretty good start. Once you get over the hurdle of setting up the preconditions it really is quite pleasant to work with. You should be amazed by the performance of the tests runs if you are from a jvm background.
What about IDE integration ? With the autotest feature I can&#8217;t say I have missed it much. I have my IDE and a visible console available and get instant feedback on saves in my IDE.</p>
</div>
<div class="paragraph">
<p>Smooth !</p>
</div>
</div>
</div></p>

	<hr />

	<p>Older posts are available in the <a href="/blog/archive.html">archive</a>.</p>

		</div>
		<div id="push"></div>
    </div>
    
    <div id="footer">
      <div class="container">
        <p class="muted credit">&copy; 2014 | Mixed with <a href="http://getbootstrap.com/">Bootstrap v3.1.1</a> | Baked with <a href="http://jbake.org">JBake v2.3.0</a></p>
      </div>
    </div>
    
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/jquery-1.11.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/prettify.js"></script>
    
  </body>
</html>